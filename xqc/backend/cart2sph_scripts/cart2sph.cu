/*
# Copyright 2025 ByteDance Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
*/

// # Portions of this file adapted from GPU4PySCF (https://github.com/pyscf/gpu4pyscf)
// # Copyright 2025 PySCF developer.
// # Licensed under the Apache License, Version 2.0.

template <int L>__device__
__forceinline__ void _cart2sph_kernel(double *gsph, double *gcart){
    if (L == 0) {
        gsph[0] = gcart[0]; // 0.282094791773878143
    }

    if (L == 1) {
        gsph[0] = gcart[0]; // 0.488602511902919921
        gsph[1] = gcart[1];
        gsph[2] = gcart[2];
    }

    if (L == 2) {
        gsph[0] = 1.092548430592079070 * gcart[1];
        gsph[1] = 1.092548430592079070 * gcart[4];
        gsph[2] = 0.630783130505040012 * gcart[5] - 0.315391565252520002 * (gcart[0] + gcart[3]);
        gsph[3] = 1.092548430592079070 * gcart[2];
        gsph[4] = 0.546274215296039535 * (gcart[0] - gcart[3]);
    }

    if (L == 3) {
        /*
        gsph[0] = 1.7701307697799304*gcart[1] + -0.5900435899266435*gcart[6];
        gsph[1] = 2.8906114426405543*gcart[4];
        gsph[2] = -0.4570457994644657*gcart[1] + -0.4570457994644657*gcart[6] + 1.8281831978578629*gcart[8];
        gsph[3] = -1.1195289977703462*gcart[2] + -1.1195289977703462*gcart[7] + 0.7463526651802308*gcart[9];
        gsph[4] = -0.4570457994644657*gcart[0] + -0.4570457994644657*gcart[3] + 1.8281831978578629*gcart[5];
        gsph[5] = 1.4453057213202771*gcart[2] + -1.4453057213202771*gcart[7];
        gsph[6] = 0.5900435899266435*gcart[0] + -1.7701307697799304*gcart[3];
        */
        // Generated by ChatGPT
        gsph[0] = 0.5900435899266435 * (3 * gcart[1] - gcart[6]);
        gsph[1] = 2.8906114426405543 * gcart[4];
        gsph[2] = 0.4570457994644657 * (4 * gcart[8] - (gcart[1] + gcart[6]));
        gsph[3] = 1.1195289977703462 * ( - (gcart[2] + gcart[7]) + (2.0/3.0) * gcart[9] );
        gsph[4] = 0.4570457994644657 * (4 * gcart[5] - (gcart[0] + gcart[3]));
        gsph[5] = 1.4453057213202771 * (gcart[2] - gcart[7]);
        gsph[6] = 0.5900435899266435 * (gcart[0] - 3 * gcart[3]);
    }

    if (L == 4) {
        /*
        gsph[0] = 2.5033429417967046*gcart[1] + -2.5033429417967046*gcart[6];
        gsph[1] = 5.310392309339791*gcart[4] + -1.7701307697799304*gcart[11];
        gsph[2] = -0.94617469575756*gcart[1] + -0.94617469575756*gcart[6] + 5.6770481745453605*gcart[8];
        gsph[3] = -2.0071396306718676*gcart[4] + -2.0071396306718676*gcart[11] + 2.676186174229157*gcart[13];
        gsph[4] = 0.31735664074561293*gcart[0] + 0.6347132814912259*gcart[3] + -2.5388531259649034*gcart[5] + 0.31735664074561293*gcart[10] + -2.5388531259649034*gcart[12] + 0.8462843753216345*gcart[14];
        gsph[5] = -2.0071396306718676*gcart[2] + -2.0071396306718676*gcart[7] + 2.676186174229157*gcart[9];
        gsph[6] = -0.47308734787878*gcart[0] + 2.8385240872726802*gcart[5] + 0.47308734787878*gcart[10] + -2.8385240872726802*gcart[12];
        gsph[7] = 1.7701307697799304*gcart[2] + -5.310392309339791*gcart[7];
        gsph[8] = 0.6258357354491761*gcart[0] + -3.755014412695057*gcart[3] + 0.6258357354491761*gcart[10];
        */
        // Generated by ChatGPT
        gsph[0] = 2.5033429417967046 * (gcart[1] - gcart[6]);
        gsph[1] = 1.7701307697799304 * (3 * gcart[4] - gcart[11]);
        gsph[2] = 0.94617469575756 * (6 * gcart[8] - gcart[1] - gcart[6]);
        gsph[3] = -2.0071396306718676 * (gcart[4] + gcart[11])
                + 2.676186174229157 * gcart[13];
        gsph[4] = 0.31735664074561293 * (gcart[0] + 2 * gcart[3] + gcart[10])
                - 2.5388531259649034 * (gcart[5] + gcart[12])
                + 0.8462843753216345 * gcart[14];
        gsph[5] = -2.0071396306718676 * (gcart[2] + gcart[7])
                + 2.676186174229157 * gcart[9];
        gsph[6] = 0.47308734787878 * ( - gcart[0] + gcart[10] + 6 * gcart[5] - 6 * gcart[12] );
        gsph[7] = 1.7701307697799304 * (gcart[2] - 3 * gcart[7]);
        gsph[8] = 0.6258357354491761 * (gcart[0] - 6 * gcart[3] + gcart[10]);
    }

    if (L == 5) {
        gsph[0] = 3.2819102842008507*gcart[1] + -6.563820568401701*gcart[6] + 0.6563820568401701*gcart[15];
        gsph[1] = 8.302649259524165*gcart[4] + -8.302649259524165*gcart[11];
        gsph[2] = -1.467714898305751*gcart[1] + -0.9784765988705008*gcart[6] + 11.741719186446009*gcart[8] + 0.4892382994352504*gcart[15] + -3.913906395482003*gcart[17];
        gsph[3] = -4.793536784973324*gcart[4] + -4.793536784973324*gcart[11] + 9.587073569946648*gcart[13];
        gsph[4] = 0.45294665119569694*gcart[1] + 0.9058933023913939*gcart[6] + -5.435359814348363*gcart[8] + 0.45294665119569694*gcart[15] + -5.435359814348363*gcart[17] + 3.6235732095655755*gcart[19];
        gsph[5] = 1.754254836801354*gcart[2] + 3.508509673602708*gcart[7] + -4.678012898136944*gcart[9] + 1.754254836801354*gcart[16] + -4.678012898136944*gcart[18] + 0.9356025796273888*gcart[20];
        gsph[6] = 0.45294665119569694*gcart[0] + 0.9058933023913939*gcart[3] + -5.435359814348363*gcart[5] + 0.45294665119569694*gcart[10] + -5.435359814348363*gcart[12] + 3.6235732095655755*gcart[14];
        gsph[7] = -2.396768392486662*gcart[2] + 4.793536784973324*gcart[9] + 2.396768392486662*gcart[16] + -4.793536784973324*gcart[18];
        gsph[8] = -0.4892382994352504*gcart[0] + 0.9784765988705008*gcart[3] + 3.913906395482003*gcart[5] + 1.467714898305751*gcart[10] + -11.741719186446009*gcart[12];
        gsph[9] = 2.075662314881041*gcart[2] + -12.453973889286248*gcart[7] + 2.075662314881041*gcart[16];
        gsph[10] = 0.6563820568401701*gcart[0] + -6.563820568401701*gcart[3] + 3.2819102842008507*gcart[10];
        /*
        // Generated by ChatGPT
        gsph[0]  = (3.2819102842008507 * gcart[1]) + (-6.563820568401701 * gcart[6]) + (0.6563820568401701 * gcart[15]);
        gsph[1]  = 8.302649259524165 * (gcart[4] - gcart[11]);
        gsph[2]  = (-1.467714898305751 * gcart[1]) + (-0.9784765988705008 * gcart[6]) + (11.741719186446009 * gcart[8]) + (0.4892382994352504 * gcart[15]) + (-3.913906395482003 * gcart[17]);
        gsph[3]  = -4.793536784973324 * (gcart[4] + gcart[11]) + 9.587073569946648 * gcart[13];
        gsph[4]  = (0.45294665119569694 * (gcart[1] + gcart[15])) + (0.9058933023913939 * gcart[6]) + (-5.435359814348363 * (gcart[8] + gcart[17])) + (3.6235732095655755 * gcart[19]);
        gsph[5]  = 1.754254836801354 * (gcart[2] + gcart[16]) + 3.508509673602708 * gcart[7] + (-4.678012898136944 * (gcart[9] + gcart[18])) + (0.9356025796273888 * gcart[20]);
        gsph[6]  = (0.45294665119569694 * (gcart[0] + gcart[10])) + (0.9058933023913939 * gcart[3]) + (-5.435359814348363 * (gcart[5] + gcart[12])) + (3.6235732095655755 * gcart[14]);
        gsph[7]  = -2.396768392486662 * (gcart[2] - gcart[16]) + 4.793536784973324 * (gcart[9] - gcart[18]);
        gsph[8]  = (-0.4892382994352504 * gcart[0]) + (0.9784765988705008 * gcart[3]) + (3.913906395482003 * gcart[5]) + (1.467714898305751 * gcart[10]) + (-11.741719186446009 * gcart[12]);
        gsph[9]  = 2.075662314881041 * (gcart[2] + gcart[16]) - 12.453973889286248 * gcart[7];
        gsph[10] = (0.6563820568401701 * gcart[0]) + (-6.563820568401701 * gcart[3]) + (3.2819102842008507 * gcart[10]);
        */
    }

    if (L == 6) {
        gsph[0] = 4.099104631151486*gcart[1] + -13.663682103838289*gcart[6] + 4.099104631151486*gcart[15];
        gsph[1] = 11.833095811158763*gcart[4] + -23.666191622317527*gcart[11] + 2.3666191622317525*gcart[22];
        gsph[2] = -2.0182596029148963*gcart[1] + 20.182596029148968*gcart[8] + 2.0182596029148963*gcart[15] + -20.182596029148968*gcart[17];
        gsph[3] = -8.29084733563431*gcart[4] + -5.527231557089541*gcart[11] + 22.108926228358165*gcart[13] + 2.7636157785447706*gcart[22] + -7.369642076119389*gcart[24];
        gsph[4] = 0.9212052595149236*gcart[1] + 1.8424105190298472*gcart[6] + -14.739284152238778*gcart[8] + 0.9212052595149236*gcart[15] + -14.739284152238778*gcart[17] + 14.739284152238778*gcart[19];
        gsph[5] = 2.913106812593657*gcart[4] + 5.826213625187314*gcart[11] + -11.652427250374627*gcart[13] + 2.913106812593657*gcart[22] + -11.652427250374627*gcart[24] + 4.6609709001498505*gcart[26];
        gsph[6] = -0.3178460113381421*gcart[0] + -0.9535380340144264*gcart[3] + 5.721228204086558*gcart[5] + -0.9535380340144264*gcart[10] + 11.442456408173117*gcart[12] + -7.628304272115411*gcart[14] + -0.3178460113381421*gcart[21] + 5.721228204086558*gcart[23] + -7.628304272115411*gcart[25] + 1.0171072362820548*gcart[27];
        gsph[7] = 2.913106812593657*gcart[2] + 5.826213625187314*gcart[7] + -11.652427250374627*gcart[9] + 2.913106812593657*gcart[16] + -11.652427250374627*gcart[18] + 4.6609709001498505*gcart[20];
        gsph[8] = 0.4606026297574618*gcart[0] + 0.4606026297574618*gcart[3] + -7.369642076119389*gcart[5] + -0.4606026297574618*gcart[10] + 7.369642076119389*gcart[14] + -0.4606026297574618*gcart[21] + 7.369642076119389*gcart[23] + -7.369642076119389*gcart[25];
        gsph[9] = -2.7636157785447706*gcart[2] + 5.527231557089541*gcart[7] + 7.369642076119389*gcart[9] + 8.29084733563431*gcart[16] + -22.108926228358165*gcart[18];
        gsph[10] = -0.5045649007287241*gcart[0] + 2.52282450364362*gcart[3] + 5.045649007287242*gcart[5] + 2.52282450364362*gcart[10] + -30.273894043723452*gcart[12] + -0.5045649007287241*gcart[21] + 5.045649007287242*gcart[23];
        gsph[11] = 2.3666191622317525*gcart[2] + -23.666191622317527*gcart[7] + 11.833095811158763*gcart[16];
        gsph[12] = 0.6831841051919144*gcart[0] + -10.247761577878716*gcart[3] + 10.247761577878716*gcart[10] + -0.6831841051919144*gcart[21];
        /*
        // Generated by ChatGPT
        gsph[0]  = 4.099104631151486 * (gcart[1] + gcart[15]) - 13.663682103838289 * gcart[6];
        gsph[1]  = 11.833095811158763 * (gcart[4] - 2 * gcart[11]) + 2.3666191622317525 * gcart[22];
        gsph[2]  = -2.0182596029148963 * (gcart[1] - gcart[15]) + 20.182596029148968 * (gcart[8] - gcart[17]);
        gsph[3]  = -8.29084733563431 * gcart[4] - 5.527231557089541 * gcart[11] + 22.108926228358165 * gcart[13] + 2.7636157785447706 * gcart[22] - 7.369642076119389 * gcart[24];
        gsph[4]  = 0.9212052595149236 * (gcart[1] + gcart[15]) + 1.8424105190298472 * gcart[6] - 14.739284152238778 * (gcart[8] + gcart[17] - gcart[19]);
        gsph[5]  = 2.913106812593657 * (gcart[4] + gcart[22]) + 5.826213625187314 * gcart[11] - 11.652427250374627 * (gcart[13] + gcart[24]) + 4.6609709001498505 * gcart[26];
        gsph[6]  = -0.3178460113381421 * (gcart[0] + gcart[21]) - 0.9535380340144264 * (gcart[3] + gcart[10]) + 5.721228204086558 * (gcart[5] + gcart[23]) + 11.442456408173117 * gcart[12] - 7.628304272115411 * (gcart[14] + gcart[25]) + 1.0171072362820548 * gcart[27];
        gsph[7]  = 2.913106812593657 * (gcart[2] + gcart[16]) + 5.826213625187314 * gcart[7] - 11.652427250374627 * (gcart[9] + gcart[18]) + 4.6609709001498505 * gcart[20];
        gsph[8]  = 0.4606026297574618 * (gcart[0] + gcart[3] - gcart[10] - gcart[21]) - 7.369642076119389 * (gcart[5] - gcart[14] + gcart[23] - gcart[25]);
        gsph[9]  = -2.7636157785447706 * gcart[2] + 5.527231557089541 * gcart[7] + 7.369642076119389 * gcart[9] + 8.29084733563431 * gcart[16] - 22.108926228358165 * gcart[18];
        gsph[10] = -0.5045649007287241 * (gcart[0] + gcart[21]) + 5.045649007287242 * (gcart[5] + gcart[23]) + 2.52282450364362 * (gcart[3] + gcart[10]) - 30.273894043723452 * gcart[12];
        gsph[11] = 2.3666191622317525 * (gcart[2] + gcart[16]) - 23.666191622317527 * gcart[7];
        gsph[12] = 0.6831841051919144 * (gcart[0] - gcart[21]) - 10.247761577878716 * (gcart[3] - gcart[10]);
        */
    }

    if(L == 7) {
        gsph[0] = 4.950139127672174*gcart[1] + -24.75069563836087*gcart[6] + 14.850417383016522*gcart[15] + -0.7071627325245963*gcart[28];
        gsph[1] = 15.8757639708114*gcart[4] + -52.919213236038004*gcart[11] + 15.8757639708114*gcart[22];
        gsph[2] = -2.594577893601302*gcart[1] + 2.594577893601302*gcart[6] + 31.134934723215622*gcart[8] + 4.670240208482344*gcart[15] + -62.269869446431244*gcart[17] + -0.5189155787202604*gcart[28] + 6.226986944643125*gcart[30];
        gsph[3] = -12.45397388928625*gcart[4] + 41.51324629762083*gcart[13] + 12.45397388928625*gcart[22] + -41.51324629762083*gcart[24];
        gsph[4] = 1.4081304047606462*gcart[1] + 2.3468840079344107*gcart[6] + -28.162608095212924*gcart[8] + 0.4693768015868821*gcart[15] + -18.77507206347528*gcart[17] + 37.55014412695057*gcart[19] + -0.4693768015868821*gcart[28] + 9.38753603173764*gcart[30] + -12.516714708983523*gcart[32];
        gsph[5] = 6.637990386674741*gcart[4] + 13.275980773349483*gcart[11] + -35.402615395598616*gcart[13] + 6.637990386674741*gcart[22] + -35.402615395598616*gcart[24] + 21.241569237359172*gcart[26];
        gsph[6] = -0.4516580379125866*gcart[1] + -1.35497411373776*gcart[6] + 10.839792909902078*gcart[8] + -1.35497411373776*gcart[15] + 21.679585819804156*gcart[17] + -21.679585819804156*gcart[19] + -0.4516580379125866*gcart[28] + 10.839792909902078*gcart[30] + -21.679585819804156*gcart[32] + 5.781222885281109*gcart[34];
        gsph[7] = -2.389949691920173*gcart[2] + -7.169849075760519*gcart[7] + 14.339698151521036*gcart[9] + -7.169849075760519*gcart[16] + 28.679396303042072*gcart[18] + -11.47175852121683*gcart[20] + -2.389949691920173*gcart[29] + 14.339698151521036*gcart[31] + -11.47175852121683*gcart[33] + 1.092548430592079*gcart[35];
        gsph[8] = -0.4516580379125866*gcart[0] + -1.35497411373776*gcart[3] + 10.839792909902078*gcart[5] + -1.35497411373776*gcart[10] + 21.679585819804156*gcart[12] + -21.679585819804156*gcart[14] + -0.4516580379125866*gcart[21] + 10.839792909902078*gcart[23] + -21.679585819804156*gcart[25] + 5.781222885281109*gcart[27];
        gsph[9] = 3.3189951933373707*gcart[2] + 3.3189951933373707*gcart[7] + -17.701307697799308*gcart[9] + -3.3189951933373707*gcart[16] + 10.620784618679586*gcart[20] + -3.3189951933373707*gcart[29] + 17.701307697799308*gcart[31] + -10.620784618679586*gcart[33];
        gsph[10] = 0.4693768015868821*gcart[0] + -0.4693768015868821*gcart[3] + -9.38753603173764*gcart[5] + -2.3468840079344107*gcart[10] + 18.77507206347528*gcart[12] + 12.516714708983523*gcart[14] + -1.4081304047606462*gcart[21] + 28.162608095212924*gcart[23] + -37.55014412695057*gcart[25];
        gsph[11] = -3.1134934723215624*gcart[2] + 15.567467361607811*gcart[7] + 10.378311574405208*gcart[9] + 15.567467361607811*gcart[16] + -62.269869446431244*gcart[18] + -3.1134934723215624*gcart[29] + 10.378311574405208*gcart[31];
        gsph[12] = -0.5189155787202604*gcart[0] + 4.670240208482344*gcart[3] + 6.226986944643125*gcart[5] + 2.594577893601302*gcart[10] + -62.269869446431244*gcart[12] + -2.594577893601302*gcart[21] + 31.134934723215622*gcart[23];
        gsph[13] = 2.6459606618019*gcart[2] + -39.6894099270285*gcart[7] + 39.6894099270285*gcart[16] + -2.6459606618019*gcart[29];
        gsph[14] = 0.7071627325245963*gcart[0] + -14.850417383016522*gcart[3] + 24.75069563836087*gcart[10] + -4.950139127672174*gcart[21];
        /*
        // Generated by ChatGPT
        gsph[0]  = 4.950139127672174 * gcart[1] - 24.75069563836087 * gcart[6] + 14.850417383016522 * gcart[15] - 0.7071627325245963 * gcart[28];
        gsph[1]  = 15.8757639708114 * (gcart[4] + gcart[22]) - 52.919213236038004 * gcart[11];
        gsph[2]  = (-2.594577893601302 * (gcart[1] - gcart[6])) + (31.134934723215622 * gcart[8]) + (4.670240208482344 * gcart[15]) - (62.269869446431244 * gcart[17]) - (0.5189155787202604 * gcart[28]) + (6.226986944643125 * gcart[30]);
        gsph[3]  = -12.45397388928625 * (gcart[4] - gcart[22]) + 41.51324629762083 * (gcart[13] - gcart[24]);
        gsph[4]  = (1.4081304047606462 * gcart[1]) + (2.3468840079344107 * gcart[6]) - (28.162608095212924 * gcart[8]) + (0.4693768015868821 * (gcart[15] - gcart[28])) - (18.77507206347528 * gcart[17]) + (37.55014412695057 * gcart[19]) + (9.38753603173764 * gcart[30]) - (12.516714708983523 * gcart[32]);
        gsph[5]  = 6.637990386674741 * (gcart[4] + gcart[22]) + 13.275980773349483 * gcart[11] - 35.402615395598616 * (gcart[13] + gcart[24]) + 21.241569237359172 * gcart[26];
        gsph[6]  = (-0.4516580379125866 * (gcart[1] + gcart[28])) + (-1.35497411373776 * (gcart[6] + gcart[15])) + (10.839792909902078 * gcart[8]) + (21.679585819804156 * (gcart[17] - gcart[19])) + (10.839792909902078 * gcart[30]) - (21.679585819804156 * gcart[32]) + (5.781222885281109 * gcart[34]);
        gsph[7]  = -2.389949691920173 * (gcart[2] + gcart[29]) - 7.169849075760519 * (gcart[7] + gcart[16]) + 14.339698151521036 * gcart[9] + 28.679396303042072 * gcart[18] - 11.47175852121683 * (gcart[20] + gcart[33]) + (1.092548430592079 * gcart[35]);
        gsph[8]  = (-0.4516580379125866 * (gcart[0] + gcart[21])) + (-1.35497411373776 * (gcart[3] + gcart[10])) + (10.839792909902078 * gcart[5]) + (21.679585819804156 * (gcart[12] - gcart[14])) + (10.839792909902078 * gcart[23]) - (21.679585819804156 * gcart[25]) + (5.781222885281109 * gcart[27]);
        gsph[9]  = 3.3189951933373707 * (gcart[2] + gcart[7] - gcart[16] - gcart[29]) - 17.701307697799308 * gcart[9] + 10.620784618679586 * (gcart[20] - gcart[33]) + 17.701307697799308 * gcart[31];
        gsph[10] = (0.4693768015868821 * (gcart[0] - gcart[3])) - (9.38753603173764 * gcart[5]) - (2.3468840079344107 * gcart[10]) + (18.77507206347528 * gcart[12]) + (12.516714708983523 * gcart[14]) - (1.4081304047606462 * gcart[21]) + (28.162608095212924 * gcart[23]) - (37.55014412695057 * gcart[25]);
        gsph[11] = (-3.1134934723215624 * (gcart[2] + gcart[29])) + (15.567467361607811 * (gcart[7] + gcart[16])) + (10.378311574405208 * gcart[9]) - (62.269869446431244 * gcart[18]) + (10.378311574405208 * gcart[31]);
        gsph[12] = (-0.5189155787202604 * gcart[0]) + (4.670240208482344 * gcart[3]) + (6.226986944643125 * gcart[5]) + (2.594577893601302 * gcart[10]) - (62.269869446431244 * gcart[12]) - (2.594577893601302 * gcart[21]) + (31.134934723215622 * gcart[23]);
        gsph[13] = (2.6459606618019 * (gcart[2] - gcart[29])) - 39.6894099270285 * (gcart[7] - gcart[16]);
        gsph[14] = (0.7071627325245963 * gcart[0]) - (14.850417383016522 * gcart[3]) + (24.75069563836087 * gcart[10]) - (4.950139127672174 * gcart[21]);
        */
    }

    if(L == 8){
        gsph[0] = 5.83141328139864*gcart[1] + -40.81989296979048*gcart[6] + 40.81989296979048*gcart[15] + -5.83141328139864*gcart[28];
        gsph[1] = 20.40994648489524*gcart[4] + -102.0497324244762*gcart[11] + 61.22983945468572*gcart[22] + -2.91570664069932*gcart[37];
        gsph[2] = -3.193996596357255*gcart[1] + 7.452658724833595*gcart[6] + 44.71595234900157*gcart[8] + 7.452658724833595*gcart[15] + -149.0531744966719*gcart[17] + -3.193996596357255*gcart[28] + 44.71595234900157*gcart[30];
        gsph[3] = -17.24955311049054*gcart[4] + 17.24955311049054*gcart[11] + 68.99821244196217*gcart[13] + 31.04919559888297*gcart[22] + -137.9964248839243*gcart[24] + -3.449910622098108*gcart[37] + 13.79964248839243*gcart[39];
        gsph[4] = 1.913666099037323*gcart[1] + 1.913666099037323*gcart[6] + -45.92798637689575*gcart[8] + -1.913666099037323*gcart[15] + 76.54664396149292*gcart[19] + -1.913666099037323*gcart[28] + 45.92798637689575*gcart[30] + -76.54664396149292*gcart[32];
        gsph[5] = 11.1173953976599*gcart[4] + 18.52899232943316*gcart[11] + -74.11596931773265*gcart[13] + 3.705798465886632*gcart[22] + -49.41064621182176*gcart[24] + 59.29277545418611*gcart[26] + -3.705798465886632*gcart[37] + 24.70532310591088*gcart[39] + -19.7642584847287*gcart[41];
        gsph[6] = -0.912304516869819*gcart[1] + -2.736913550609457*gcart[6] + 27.36913550609457*gcart[8] + -2.736913550609457*gcart[15] + 54.73827101218914*gcart[17] + -72.98436134958553*gcart[19] + -0.912304516869819*gcart[28] + 27.36913550609457*gcart[30] + -72.98436134958553*gcart[32] + 29.19374453983421*gcart[34];
        gsph[7] = -3.8164436064573*gcart[4] + -11.4493308193719*gcart[11] + 30.5315488516584*gcart[13] + -11.4493308193719*gcart[22] + 61.06309770331679*gcart[24] + -36.63785862199007*gcart[26] + -3.8164436064573*gcart[37] + 30.5315488516584*gcart[39] + -36.63785862199007*gcart[41] + 6.978639737521918*gcart[43];
        gsph[8] = 0.3180369672047749*gcart[0] + 1.272147868819099*gcart[3] + -10.1771829505528*gcart[5] + 1.908221803228649*gcart[10] + -30.53154885165839*gcart[12] + 30.53154885165839*gcart[14] + 1.272147868819099*gcart[21] + -30.53154885165839*gcart[23] + 61.06309770331677*gcart[25] + -16.28349272088447*gcart[27] + 0.3180369672047749*gcart[36] + -10.1771829505528*gcart[38] + 30.53154885165839*gcart[40] + -16.28349272088447*gcart[42] + 1.16310662292032*gcart[44];
        gsph[9] = -3.8164436064573*gcart[2] + -11.4493308193719*gcart[7] + 30.5315488516584*gcart[9] + -11.4493308193719*gcart[16] + 61.06309770331679*gcart[18] + -36.63785862199007*gcart[20] + -3.8164436064573*gcart[29] + 30.5315488516584*gcart[31] + -36.63785862199007*gcart[33] + 6.978639737521918*gcart[35];
        gsph[10] = -0.4561522584349095*gcart[0] + -0.912304516869819*gcart[3] + 13.68456775304729*gcart[5] + 13.68456775304729*gcart[12] + -36.49218067479276*gcart[14] + 0.912304516869819*gcart[21] + -13.68456775304729*gcart[23] + 14.5968722699171*gcart[27] + 0.4561522584349095*gcart[36] + -13.68456775304729*gcart[38] + 36.49218067479276*gcart[40] + -14.5968722699171*gcart[42];
        gsph[11] = 3.705798465886632*gcart[2] + -3.705798465886632*gcart[7] + -24.70532310591088*gcart[9] + -18.52899232943316*gcart[16] + 49.41064621182176*gcart[18] + 19.7642584847287*gcart[20] + -11.1173953976599*gcart[29] + 74.11596931773265*gcart[31] + -59.29277545418611*gcart[33];
        gsph[12] = 0.4784165247593308*gcart[0] + -1.913666099037323*gcart[3] + -11.48199659422394*gcart[5] + -4.784165247593307*gcart[10] + 57.40998297111968*gcart[12] + 19.13666099037323*gcart[14] + -1.913666099037323*gcart[21] + 57.40998297111968*gcart[23] + -114.8199659422394*gcart[25] + 0.4784165247593308*gcart[36] + -11.48199659422394*gcart[38] + 19.13666099037323*gcart[40];
        gsph[13] = -3.449910622098108*gcart[2] + 31.04919559888297*gcart[7] + 13.79964248839243*gcart[9] + 17.24955311049054*gcart[16] + -137.9964248839243*gcart[18] + -17.24955311049054*gcart[29] + 68.99821244196217*gcart[31];
        gsph[14] = -0.5323327660595425*gcart[0] + 7.452658724833595*gcart[3] + 7.452658724833595*gcart[5] + -111.7898808725039*gcart[12] + -7.452658724833595*gcart[21] + 111.7898808725039*gcart[23] + 0.5323327660595425*gcart[36] + -7.452658724833595*gcart[38];
        gsph[15] = 2.91570664069932*gcart[2] + -61.22983945468572*gcart[7] + 102.0497324244762*gcart[16] + -20.40994648489524*gcart[29];
        gsph[16] = 0.72892666017483*gcart[0] + -20.40994648489524*gcart[3] + 51.0248662122381*gcart[10] + -20.40994648489524*gcart[21] + 0.72892666017483*gcart[36];
        /*
        // Generated by ChatGPT
        gsph[0]  = 5.83141328139864 * (gcart[1] - gcart[28]) + 40.81989296979048 * (gcart[15] - gcart[6]);
        gsph[1]  = 20.40994648489524 * (gcart[4] - 5 * gcart[11]) + 61.22983945468572 * gcart[22] - 2.91570664069932 * gcart[37];
        gsph[2]  = -3.193996596357255 * (gcart[1] + gcart[28]) + 7.452658724833595 * (gcart[6] + gcart[15]) + 44.71595234900157 * (gcart[8] + gcart[30]) - 149.0531744966719 * gcart[17];
        gsph[3]  = -17.24955311049054 * (gcart[4] - gcart[11]) + 68.99821244196217 * gcart[13] + 31.04919559888297 * gcart[22] - 137.9964248839243 * gcart[24] - 3.449910622098108 * gcart[37] + 13.79964248839243 * gcart[39];
        gsph[4]  = 1.913666099037323 * (gcart[1] + gcart[6] - gcart[15] - gcart[28]) - 45.92798637689575 * gcart[8] + 76.54664396149292 * (gcart[19] - gcart[32]) + 45.92798637689575 * gcart[30];
        gsph[5]  = 11.1173953976599 * gcart[4] + 18.52899232943316 * gcart[11] - 74.11596931773265 * gcart[13] + 3.705798465886632 * (gcart[22] - gcart[37]) - 49.41064621182176 * gcart[24] + 59.29277545418611 * gcart[26] + 24.70532310591088 * gcart[39] - 19.7642584847287 * gcart[41];
        gsph[6]  = -0.912304516869819 * (gcart[1] + gcart[28]) - 2.736913550609457 * (gcart[6] + gcart[15]) + 27.36913550609457 * (gcart[8] + gcart[30]) + 54.73827101218914 * gcart[17] - 72.98436134958553 * gcart[19] - 72.98436134958553 * gcart[32] + 29.19374453983421 * gcart[34];
        gsph[7]  = -3.8164436064573 * (gcart[4] + gcart[37]) - 11.4493308193719 * (gcart[11] + gcart[22]) + 30.5315488516584 * (gcart[13] + gcart[39]) + 61.06309770331679 * gcart[24] - 36.63785862199007 * (gcart[26] + gcart[41]) + 6.978639737521918 * gcart[43];
        gsph[8]  = 0.3180369672047749 * (gcart[0] + gcart[36]) + 1.272147868819099 * (gcart[3] + gcart[21]) - 10.1771829505528 * (gcart[5] + gcart[38]) + 1.908221803228649 * gcart[10] - 30.53154885165839 * (gcart[12] - gcart[14] + gcart[23] - gcart[25] + gcart[40]) + 61.06309770331677 * gcart[25] - 16.28349272088447 * (gcart[27] + gcart[42]) + 1.16310662292032 * gcart[44];
        gsph[9]  = -3.8164436064573 * (gcart[2] + gcart[29]) - 11.4493308193719 * (gcart[7] + gcart[16]) + 30.5315488516584 * gcart[9] + 61.06309770331679 * gcart[18] - 36.63785862199007 * (gcart[20] + gcart[33]) + 6.978639737521918 * gcart[35];
        gsph[10] = -0.4561522584349095 * (gcart[0] + gcart[36]) - 0.912304516869819 * (gcart[3] - gcart[21]) + 13.68456775304729 * (gcart[5] + gcart[12] - gcart[23] - gcart[38]) - 36.49218067479276 * gcart[14] + 14.5968722699171 * (gcart[27] - gcart[42]);
        gsph[11] = 3.705798465886632 * (gcart[2] - gcart[7]) - 24.70532310591088 * gcart[9] - 18.52899232943316 * gcart[16] + 49.41064621182176 * gcart[18] + 19.7642584847287 * gcart[20] - 11.1173953976599 * gcart[29] + 74.11596931773265 * gcart[31] - 59.29277545418611 * gcart[33];
        gsph[12] = 0.4784165247593308 * (gcart[0] + gcart[36]) - 1.913666099037323 * (gcart[3] + gcart[21]) - 11.48199659422394 * (gcart[5] + gcart[38]) - 4.784165247593307 * gcart[10] + 57.40998297111968 * (gcart[12] + gcart[23]) + 19.13666099037323 * (gcart[14] + gcart[40]) - 114.8199659422394 * gcart[25];
        gsph[13] = -3.449910622098108 * (gcart[2] - gcart[29]) + 31.04919559888297 * gcart[7] + 13.79964248839243 * gcart[9] + 17.24955311049054 * gcart[16] - 137.9964248839243 * gcart[18] + 68.99821244196217 * gcart[31];
        gsph[14] = -0.5323327660595425 * (gcart[0] + gcart[36]) + 7.452658724833595 * (gcart[3] + gcart[5] - gcart[21] - gcart[38]) - 111.7898808725039 * (gcart[12] - gcart[23]);
        gsph[15] = 2.91570664069932 * gcart[2] - 61.22983945468572 * gcart[7] + 102.0497324244762 * gcart[16] - 20.40994648489524 * gcart[29];
        gsph[16] = 0.72892666017483 * (gcart[0] + gcart[36]) - 20.40994648489524 * (gcart[3] + gcart[21]) + 51.0248662122381 * gcart[10];
        */
    }

    if (L == 9){
        gsph[0] = 6.740108566678694*gcart[1] + -62.9076799556678*gcart[6] + 94.36151993350171*gcart[15] + -26.96043426671477*gcart[28] + 0.7489009518531882*gcart[45];
        gsph[1] = 25.41854119163758*gcart[4] + -177.9297883414631*gcart[11] + 177.9297883414631*gcart[22] + -25.41854119163758*gcart[37];
        gsph[2] = -3.814338369408373*gcart[1] + 15.25735347763349*gcart[6] + 61.02941391053396*gcart[8] + 7.628676738816745*gcart[15] + -305.1470695526698*gcart[17] + -10.89810962688107*gcart[28] + 183.0882417316019*gcart[30] + 0.5449054813440533*gcart[45] + -8.718487701504852*gcart[47];
        gsph[3] = -22.65129549625621*gcart[4] + 52.85302282459782*gcart[11] + 105.7060456491956*gcart[13] + 52.85302282459782*gcart[22] + -352.3534854973187*gcart[24] + -22.65129549625621*gcart[37] + 105.7060456491956*gcart[39];
        gsph[4] = 2.436891395195093*gcart[1] + -68.23295906546261*gcart[8] + -6.82329590654626*gcart[15] + 68.23295906546261*gcart[17] + 136.4659181309252*gcart[19] + -3.899026232312149*gcart[28] + 122.8193263178327*gcart[30] + -272.9318362618504*gcart[32] + 0.4873782790390186*gcart[45] + -13.64659181309252*gcart[47] + 27.29318362618504*gcart[49];
        gsph[5] = 16.31079695491669*gcart[4] + 16.31079695491669*gcart[11] + -130.4863756393335*gcart[13] + -16.31079695491669*gcart[22] + 130.4863756393335*gcart[26] + -16.31079695491669*gcart[37] + 130.4863756393335*gcart[39] + -130.4863756393335*gcart[41];
        gsph[6] = -1.385125560048583*gcart[1] + -3.693668160129556*gcart[6] + 49.864520161749*gcart[8] + -2.770251120097167*gcart[15] + 83.107533602915*gcart[17] + -166.21506720583*gcart[19] + 16.621506720583*gcart[30] + -110.8100448038867*gcart[32] + 88.64803584310934*gcart[34] + 0.4617085200161945*gcart[45] + -16.621506720583*gcart[47] + 55.40502240194333*gcart[49] + -29.54934528103645*gcart[51];
        gsph[7] = -8.46325696792098*gcart[4] + -25.38977090376294*gcart[11] + 84.6325696792098*gcart[13] + -25.38977090376294*gcart[22] + 169.2651393584196*gcart[24] + -135.4121114867357*gcart[26] + -8.46325696792098*gcart[37] + 84.6325696792098*gcart[39] + -135.4121114867357*gcart[41] + 38.68917471049591*gcart[43];
        gsph[8] = 0.451093112065591*gcart[1] + 1.804372448262364*gcart[6] + -18.04372448262364*gcart[8] + 2.706558672393546*gcart[15] + -54.13117344787092*gcart[17] + 72.17489793049457*gcart[19] + 1.804372448262364*gcart[28] + -54.13117344787092*gcart[30] + 144.3497958609891*gcart[32] + -57.73991834439565*gcart[34] + 0.451093112065591*gcart[45] + -18.04372448262364*gcart[47] + 72.17489793049457*gcart[49] + -57.73991834439565*gcart[51] + 8.248559763485094*gcart[53];
        gsph[9] = 3.026024588281776*gcart[2] + 12.1040983531271*gcart[7] + -32.27759560833895*gcart[9] + 18.15614752969066*gcart[16] + -96.83278682501685*gcart[18] + 58.0996720950101*gcart[20] + 12.1040983531271*gcart[29] + -96.83278682501685*gcart[31] + 116.1993441900202*gcart[33] + -22.1332084171467*gcart[35] + 3.026024588281776*gcart[46] + -32.27759560833895*gcart[48] + 58.0996720950101*gcart[50] + -22.1332084171467*gcart[52] + 1.229622689841484*gcart[54];
        gsph[10] = 0.451093112065591*gcart[0] + 1.804372448262364*gcart[3] + -18.04372448262364*gcart[5] + 2.706558672393546*gcart[10] + -54.13117344787092*gcart[12] + 72.17489793049457*gcart[14] + 1.804372448262364*gcart[21] + -54.13117344787092*gcart[23] + 144.3497958609891*gcart[25] + -57.73991834439565*gcart[27] + 0.451093112065591*gcart[36] + -18.04372448262364*gcart[38] + 72.17489793049457*gcart[40] + -57.73991834439565*gcart[42] + 8.248559763485094*gcart[44];
        gsph[11] = -4.23162848396049*gcart[2] + -8.46325696792098*gcart[7] + 42.3162848396049*gcart[9] + 42.3162848396049*gcart[18] + -67.70605574336784*gcart[20] + 8.46325696792098*gcart[29] + -42.3162848396049*gcart[31] + 19.34458735524795*gcart[35] + 4.23162848396049*gcart[46] + -42.3162848396049*gcart[48] + 67.70605574336784*gcart[50] + -19.34458735524795*gcart[52];
        gsph[12] = -0.4617085200161945*gcart[0] + 16.621506720583*gcart[5] + 2.770251120097167*gcart[10] + -16.621506720583*gcart[12] + -55.40502240194333*gcart[14] + 3.693668160129556*gcart[21] + -83.107533602915*gcart[23] + 110.8100448038867*gcart[25] + 29.54934528103645*gcart[27] + 1.385125560048583*gcart[36] + -49.864520161749*gcart[38] + 166.21506720583*gcart[40] + -88.64803584310934*gcart[42];
        gsph[13] = 4.077699238729173*gcart[2] + -16.31079695491669*gcart[7] + -32.62159390983339*gcart[9] + -40.77699238729173*gcart[16] + 163.1079695491669*gcart[18] + 32.62159390983339*gcart[20] + -16.31079695491669*gcart[29] + 163.1079695491669*gcart[31] + -195.7295634590003*gcart[33] + 4.077699238729173*gcart[46] + -32.62159390983339*gcart[48] + 32.62159390983339*gcart[50];
        gsph[14] = 0.4873782790390186*gcart[0] + -3.899026232312149*gcart[3] + -13.64659181309252*gcart[5] + -6.82329590654626*gcart[10] + 122.8193263178327*gcart[12] + 27.29318362618504*gcart[14] + 68.23295906546261*gcart[23] + -272.9318362618504*gcart[25] + 2.436891395195093*gcart[36] + -68.23295906546261*gcart[38] + 136.4659181309252*gcart[40];
        gsph[15] = -3.775215916042701*gcart[2] + 52.85302282459782*gcart[7] + 17.61767427486594*gcart[9] + -264.2651141229891*gcart[18] + -52.85302282459782*gcart[29] + 264.2651141229891*gcart[31] + 3.775215916042701*gcart[46] + -17.61767427486594*gcart[48];
        gsph[16] = -0.5449054813440533*gcart[0] + 10.89810962688107*gcart[3] + 8.718487701504852*gcart[5] + -7.628676738816745*gcart[10] + -183.0882417316019*gcart[12] + -15.25735347763349*gcart[21] + 305.1470695526698*gcart[23] + 3.814338369408373*gcart[36] + -61.02941391053396*gcart[38];
        gsph[17] = 3.177317648954698*gcart[2] + -88.96489417073154*gcart[7] + 222.4122354268289*gcart[16] + -88.96489417073154*gcart[29] + 3.177317648954698*gcart[46];
        gsph[18] = 0.7489009518531882*gcart[0] + -26.96043426671477*gcart[3] + 94.36151993350171*gcart[10] + -62.9076799556678*gcart[21] + 6.740108566678694*gcart[36];
    }
    if (L == 10){
        gsph[0] = 7.673951182219901*gcart[1] + -92.08741418663881*gcart[6] + 193.3835697919415*gcart[15] + -92.08741418663881*gcart[28] + 7.673951182219901*gcart[45];
        gsph[1] = 30.88705769902543*gcart[4] + -288.2792051909041*gcart[11] + 432.4188077863561*gcart[22] + -123.5482307961017*gcart[37] + 3.431895299891715*gcart[56];
        gsph[2] = -4.453815461763347*gcart[1] + 26.72289277058008*gcart[6] + 80.16867831174027*gcart[8] + -561.1807481821819*gcart[17] + -26.72289277058008*gcart[28] + 561.1807481821819*gcart[30] + 4.453815461763347*gcart[45] + -80.16867831174027*gcart[47];
        gsph[3] = -28.63763513582592*gcart[4] + 114.5505405433037*gcart[11] + 152.7340540577382*gcart[13] + 57.27527027165184*gcart[22] + -763.6702702886912*gcart[24] + -81.82181467378834*gcart[37] + 458.2021621732147*gcart[39] + 4.091090733689417*gcart[56] + -21.81915057967689*gcart[58];
        gsph[4] = 2.976705744527138*gcart[1] + -3.968940992702851*gcart[6] + -95.25458382486842*gcart[8] + -13.89129347445998*gcart[15] + 222.2606955913596*gcart[17] + 222.2606955913597*gcart[19] + -3.968940992702851*gcart[28] + 222.2606955913596*gcart[30] + -740.8689853045323*gcart[32] + 2.976705744527138*gcart[45] + -95.25458382486842*gcart[47] + 222.2606955913597*gcart[49];
        gsph[5] = 22.18705464592268*gcart[4] + -207.0791766952783*gcart[13] + -62.12375300858349*gcart[22] + 207.0791766952783*gcart[24] + 248.495012034334*gcart[26] + -35.49928743347628*gcart[37] + 372.742518051501*gcart[39] + -496.990024068668*gcart[41] + 4.437410929184535*gcart[56] + -41.41583533905566*gcart[58] + 49.6990024068668*gcart[60];
        gsph[6] = -1.870976726712969*gcart[1] + -3.741953453425937*gcart[6] + 78.58102252194469*gcart[8] + 78.58102252194469*gcart[17] + -314.3240900877788*gcart[19] + 3.741953453425937*gcart[28] + -78.58102252194469*gcart[30] + 209.5493933918525*gcart[34] + 1.870976726712969*gcart[45] + -78.58102252194469*gcart[47] + 314.3240900877788*gcart[49] + -209.5493933918525*gcart[51];
        gsph[7] = -13.89129347445998*gcart[4] + -37.04344926522661*gcart[11] + 166.6955216935197*gcart[13] + -27.78258694891996*gcart[22] + 277.8258694891996*gcart[24] + -333.3910433870395*gcart[26] + 55.56517389783991*gcart[39] + -222.2606955913596*gcart[41] + 127.0061117664912*gcart[43] + 4.630431158153326*gcart[56] + -55.56517389783991*gcart[58] + 111.1303477956798*gcart[60] + -42.33537058883041*gcart[62];
        gsph[8] = 0.9081022627604556*gcart[1] + 3.632409051041822*gcart[6] + -43.58890861250187*gcart[8] + 5.448613576562733*gcart[15] + -130.7667258375056*gcart[17] + 217.9445430625093*gcart[19] + 3.632409051041822*gcart[28] + -130.7667258375056*gcart[30] + 435.8890861250187*gcart[32] + -232.4741792666766*gcart[34] + 0.9081022627604556*gcart[45] + -43.58890861250187*gcart[47] + 217.9445430625093*gcart[49] + -232.4741792666766*gcart[51] + 49.815895557145*gcart[53];
        gsph[9] = 4.718637772708116*gcart[4] + 18.87455109083247*gcart[11] + -62.91517030277488*gcart[13] + 28.3118266362487*gcart[22] + -188.7455109083247*gcart[24] + 150.9964087266597*gcart[26] + 18.87455109083247*gcart[37] + -188.7455109083247*gcart[39] + 301.9928174533194*gcart[41] + -86.28366212951984*gcart[43] + 4.718637772708116*gcart[56] + -62.91517030277488*gcart[58] + 150.9964087266597*gcart[60] + -86.28366212951984*gcart[62] + 9.587073569946648*gcart[64];
        gsph[10] = -0.3181304937373671*gcart[0] + -1.590652468686835*gcart[3] + 15.90652468686835*gcart[5] + -3.181304937373671*gcart[10] + 63.62609874747341*gcart[12] + -84.83479832996456*gcart[14] + -3.181304937373671*gcart[21] + 95.43914812121012*gcart[23] + -254.5043949898937*gcart[25] + 101.8017579959575*gcart[27] + -1.590652468686835*gcart[36] + 63.62609874747341*gcart[38] + -254.5043949898937*gcart[40] + 203.6035159919149*gcart[42] + -29.08621657027356*gcart[44] + -0.3181304937373671*gcart[55] + 15.90652468686835*gcart[57] + -84.83479832996456*gcart[59] + 101.8017579959575*gcart[61] + -29.08621657027356*gcart[63] + 1.292720736456603*gcart[65];
        gsph[11] = 4.718637772708116*gcart[2] + 18.87455109083247*gcart[7] + -62.91517030277488*gcart[9] + 28.3118266362487*gcart[16] + -188.7455109083247*gcart[18] + 150.9964087266597*gcart[20] + 18.87455109083247*gcart[29] + -188.7455109083247*gcart[31] + 301.9928174533194*gcart[33] + -86.28366212951984*gcart[35] + 4.718637772708116*gcart[46] + -62.91517030277488*gcart[48] + 150.9964087266597*gcart[50] + -86.28366212951984*gcart[52] + 9.587073569946648*gcart[54];
        gsph[12] = 0.4540511313802278*gcart[0] + 1.362153394140683*gcart[3] + -21.79445430625093*gcart[5] + 0.9081022627604556*gcart[10] + -43.58890861250187*gcart[12] + 108.9722715312547*gcart[14] + -0.9081022627604556*gcart[21] + 108.9722715312547*gcart[25] + -116.2370896333383*gcart[27] + -1.362153394140683*gcart[36] + 43.58890861250187*gcart[38] + -108.9722715312547*gcart[40] + 24.9079477785725*gcart[44] + -0.4540511313802278*gcart[55] + 21.79445430625093*gcart[57] + -108.9722715312547*gcart[59] + 116.2370896333383*gcart[61] + -24.9079477785725*gcart[63];
        gsph[13] = -4.630431158153326*gcart[2] + 55.56517389783991*gcart[9] + 27.78258694891996*gcart[16] + -55.56517389783991*gcart[18] + -111.1303477956798*gcart[20] + 37.04344926522661*gcart[29] + -277.8258694891996*gcart[31] + 222.2606955913596*gcart[33] + 42.33537058883041*gcart[35] + 13.89129347445998*gcart[46] + -166.6955216935197*gcart[48] + 333.3910433870395*gcart[50] + -127.0061117664912*gcart[52];
        gsph[14] = -0.4677441816782422*gcart[0] + 1.403232545034726*gcart[3] + 19.64525563048617*gcart[5] + 6.548418543495391*gcart[10] + -78.58102252194469*gcart[12] + -78.58102252194469*gcart[14] + 6.548418543495391*gcart[21] + -196.4525563048617*gcart[23] + 392.9051126097235*gcart[25] + 52.38734834796313*gcart[27] + 1.403232545034726*gcart[36] + -78.58102252194469*gcart[38] + 392.9051126097235*gcart[40] + -314.3240900877788*gcart[42] + -0.4677441816782422*gcart[55] + 19.64525563048617*gcart[57] + -78.58102252194469*gcart[59] + 52.38734834796313*gcart[61];
        gsph[15] = 4.437410929184535*gcart[2] + -35.49928743347628*gcart[7] + -41.41583533905566*gcart[9] + -62.12375300858349*gcart[16] + 372.742518051501*gcart[18] + 49.6990024068668*gcart[20] + 207.0791766952783*gcart[31] + -496.990024068668*gcart[33] + 22.18705464592268*gcart[46] + -207.0791766952783*gcart[48] + 248.495012034334*gcart[50];
        gsph[16] = 0.4961176240878564*gcart[0] + -6.449529113142133*gcart[3] + -15.8757639708114*gcart[5] + -6.945646737229989*gcart[10] + 222.2606955913596*gcart[12] + 37.04344926522661*gcart[14] + 6.945646737229989*gcart[21] + -555.6517389783992*gcart[25] + 6.449529113142133*gcart[36] + -222.2606955913596*gcart[38] + 555.6517389783992*gcart[40] + -0.4961176240878564*gcart[55] + 15.8757639708114*gcart[57] + -37.04344926522661*gcart[59];
        gsph[17] = -4.091090733689417*gcart[2] + 81.82181467378834*gcart[7] + 21.81915057967689*gcart[9] + -57.27527027165184*gcart[16] + -458.2021621732147*gcart[18] + -114.5505405433037*gcart[29] + 763.6702702886912*gcart[31] + 28.63763513582592*gcart[46] + -152.7340540577382*gcart[48];
        gsph[18] = -0.5567269327204184*gcart[0] + 15.0316271834513*gcart[3] + 10.02108478896753*gcart[5] + -23.38253117425757*gcart[10] + -280.590374091091*gcart[12] + -23.38253117425757*gcart[21] + 701.4759352277273*gcart[23] + 15.0316271834513*gcart[36] + -280.590374091091*gcart[38] + -0.5567269327204184*gcart[55] + 10.02108478896753*gcart[57];
        gsph[19] = 3.431895299891715*gcart[2] + -123.5482307961017*gcart[7] + 432.4188077863561*gcart[16] + -288.2792051909041*gcart[29] + 30.88705769902543*gcart[46];
        gsph[20] = 0.7673951182219901*gcart[0] + -34.53278031998956*gcart[3] + 161.1529748266179*gcart[10] + -161.1529748266179*gcart[21] + 34.53278031998956*gcart[36] + -0.7673951182219901*gcart[55];
    }

}

extern "C" __global__
void cart2sph(double *gcart, double *gsph, int nao, int nbas, 
            int cart_ao_stride, int sph_ao_stride, int shell_stride,
            int* cart_offset, int* sph_offset){
    constexpr int nf_cart = (ang+1)*(ang+2)/2;
    constexpr int nf_sph = 2*ang+1;
    
    int iao = blockIdx.x * blockDim.x + threadIdx.x;
    int jsh = blockIdx.y * blockDim.y + threadIdx.y;

    if (iao >= nao || jsh >= nbas) return;

    gcart += iao*cart_ao_stride + cart_offset[jsh]*shell_stride;
    gsph += iao*sph_ao_stride + sph_offset[jsh]*shell_stride;
    
    double gcart_reg[nf_cart];
    for (int i = 0; i < nf_cart; i++){
        gcart_reg[i] = gcart[i*shell_stride];
    }
    double gsph_reg[nf_sph];
    _cart2sph_kernel<ang>(gsph_reg, gcart_reg);

    for (int i = 0; i < nf_sph; i++){
        gsph[i*shell_stride] = gsph_reg[i];
    }
}

